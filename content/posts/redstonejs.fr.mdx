---
title: '"Iron-golem" le projet de réecrire mineflayer en typescript'
description: Mon projet de réecrire mineflayer en typescript.
date: 2023-09-10
authors: AugustinMauroy
keywords:
  - mineflayer
  - typescript
  - iron-golem
  - redstoneJS
---

Pourquoi ai-je cette idée ? Tout simplement car je trouve que mineflayer à plusieur défauts. J'ai déjà pris contact avec les maintainer pour faire changer les choses mais en vain.

## Les défauts de mineflayer

### La documentation

Il y a plusieurs points qui fons que la docs est difficile à lire.

1. Le choix d'utiliser docsify, il n'est pas très flexible comparé à d'autre alternative un peux plus complex en infrastructure mais qui offre une meilleur expérience utilisateur. (comme [docusaurus](https://docusaurus.io/)) ou [nextra](https://nextra.site/) _celui-ci n'est pas très bien maintenu_.
2. La docs n'est pas complete, il manque des choses comme les events, les méthodes, les propriétés, etc...

### Le typage de la librairie

Le typage de la librairie est très mauvais, il y a beaucoup de chose qui ne sont pas typé, et les choses qui sont typé sont mal typé. Car le typage est réalisté à la main et non pas généré automatiquement.

Pour le moment il commence à utilisr JSdoc typé le projet mais JSdocs n'est pas aussi puissant que typescript.

### `CJS` Et `ESM`

Mineflayer utilise `CJS` mais ne supporte pas `ESM` ce qui est un problème car `ESM` est le futur de nodejs. Et il y a beaucoup de problème avec `CJS` comme le fait que les import ne sont pas typé, et que les import ne sont pas asynchrone.

## Poblème de l'organisation

La structure des différent projet n'est pas la même ce qui est un problème car il faut que les différent projet soit organisé de la même manière pour que les utilisateur ne soit pas perdu.

Aussi il y a un manque d'invitation à rejoindre l'organisation. Comme dit dans [cette article](https://opensource.guide/fr/building-community/#partager-la-propriété-de-votre-projet) invité les gens dans le projet en temps que colaborateur est un bon moyen de faire grandir la communauté.

## La solution

La solution est simple, réecrire mineflayer en typescript. Cela permettrais d'avoir une meilleur documentation, un meilleur typage, et une meilleur expérience utilisateur.

### Comment ?

Pour cela il faut que je crée une organisation github qui s'appelle `redstoneJS` et que je crée un projet qui s'appelle `iron-golem`

### Les test unitaire

Pour la version majeur `1` du projet, il faut que les test unitaire soit exactement les même que ceux de mineflayer. Pour cela il faut que je fasse un script/action github qui vérifie si il y a des différences entre les test de mineflayer et les test de iron-golem.

### Migrer vers typescript

Il faudras que quelqu'un écrive l'init commit de iron-golem. Pour enssuit mettre tous les fichier en typescript et `esm` pour export `esm` et `cjs`grace au compilateur typescript. Mais tous les fichier non-typé aurons un `@ts-nocheck` pour que le compilateur ne vérifie pas les types.

Des issue seront ouverte pour chaque fichier non-typé pour que les gens puisse les typé. A chaque fois qu'un fichier seras update il faudras update la docs et les test unitaire.

### CI, CD

Il faut aussi mettre en place un ci, cd comme sur mineflayer. Pour cela il faut utiliser github action.

### La docs

Pour cela je comptais faire en sorte qu'elle soit écrite en [MDX](https://mdxjs.com/) et qu'elle soit généré avec [docusaurus](https://docusaurus.io/).

### CII best practice and OSSF scorecard

Il faut aussi que le projet soit conforme au [CII best practice](https://bestpractices.coreinfrastructure.org/fr) et au [OSSF scorecard](https://github.com/ossf/scorecard).

Et aussi repecter toutes les bonne pratique open source.

## Conclusion

Voila, j'espère que ce projet vous plaira. Si vous voulez m'aider vous pouvez me contacter sur [twitter](https://twitter.com/AugustinMauroy).

Il reste encore des zone d'ombre dans ce projet, mais je pense que c'est un bon début. Par example au sujet des dépendance faut-ils les fork ou les laisser comme elle sont ? Je pense que les fork est la meilleur solution car cela permet d'avoir un meilleur contrôle sur les dépendance.
